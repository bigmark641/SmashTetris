<html>
<head>
</head>
<body style="margin: 0">
    <canvas id="canvas" style="border: 1px solid black;"></canvas>
    <script src="PlayerEngine.js"></script>
    <script src="RaycastingEngine.js"></script>
    <script src="TetrisEngine.js"></script>
    <script src="GameEngine.js"></script>
    <script>
        "use strict";


        /////////////////////////////
        // Global config constants //
        /////////////////////////////

        window.VIEWPORT_WIDTH_PIXELS = 660;    //How many pixels wide the viewport is
        window.VIEWPORT_HEIGHT_PIXELS = 360;   //How many pixels tall the viewport is
        window.VIEWPORT_WIDTH_DEGREES = 75;    //How wide the player can see (between 1 and 179 degrees)
        window.COLUMN_WIDTH_PIXELS = 1;        //How wide each "drawn" line is (1 is highest resolution)
        window.MAX_FRAMERATE = 45;             //The framerate the graphics engine will target
        window.WALL_HEIGHT = 1;                //How tall each wall should be (1 is a cube)
        window.SKY_COLOR = "#99d9ea";          //Hex color of the sky
        window.GROUND_COLOR = "#22b14c";       //Hex color of the ground
        window.WALL_COLORS = ["#999999", "#990000", '#000066'];        //Hex colors of the different wall types
        window.WALL_COLORS_FACING = ["#999999", "#DD0000", '#000066']; //Hex colors when the user is pointed at the wall
        window.WALL_SHADING_PERCENT = -15;     //Color difference of perpendicular walls
        window.WALL_DISTANCE_SHADE = -.85;     //How much darker far away objects should appear
        window.KEYBOARD_TURNING_SPEED = .002;    //How fast the player turns with the keyboard
        window.MOUSE_SENSITIVITY = .001;       //How fast the mouse turns
        window.PLAYER_WALKING_SPEED = .01;     //How fast the player walks
        window.PLAYER_ACCELERATION = .0015;    //How fast the player accelerates
        window.PLAYER_STARTING_X = 8;          //Player's starting X location
        window.PLAYER_STARTING_Y = 4;          //Player's starting Y location
        window.PLAYER_STARTING_ANGLE_DEGREES = 90;             //Direction player is looking at start
        window.VIEWPORT_CROSSHAIR_SIZE_PIXELS = 10;            //The height and width of the crosshairs
        window.VIEWPORT_CROSSHAIR_COLOR = "#000000";           //The color of the crosshairs
        window.TETRIS_STARTING_TICK_SPEED_MILLISECONDS = 2000; //The initial speed of the tetris engine
        window.TETRIS_STARTING_LEVEL = 0;                      //The initial level of the tetris engine
        window.TETRIS_SPEED_PER_LEVEL_MILLISECONDS = 100;      //How much the tetris tick speed decreases each level
        window.TETRIS_DROP_TICK_SPEED_MILLISECONDS = 10;       //The tetris tick speed when pieces are dropping
        window.PLAYER_PUSHED_BUFFER = .001;                    //How close a player can be to a wall
        window.WALL_TYPE_NONE = 0;                             //Empty space in the world array
        window.WALL_TYPE_ARENA = 1;                            //Outer wall block in the world array
        window.WALL_TYPE_PIECE_ACTIVE = 2;                     //Active tetris block in the world array
        window.WALL_TYPE_PIECE_INACTIVE = 3;                   //Inactive tetris block in the world array
        window.CONFIG_VALUE_WAIT_TIME_MILLISECONDS = 1000;     //How long the page will wait for config values from the parent page


        //////////////////////
        // Global variables //
        //////////////////////

        var world = [
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
        ];
        var playerX;
        var playerY;
        var playerA;
        var playerVerticalA;
        var isGameInProgress = false;
        var canvasContext;


        /////////////////////////
        // Initialization code //
        /////////////////////////

        (function () {
            new GameEngine();
        })();
    </script>
</body>
</html>
